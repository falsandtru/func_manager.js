<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>QUnit</title>
  <link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.14.0.css">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
  <script src="//code.jquery.com/qunit/qunit-1.14.0.js"></script>
  <script src="/lib/func_manager.js"></script>
<script>
( function () {
	var count = 0;
	fm('demo');
	fma.demo = function(){count--};
	fma.demo = function(){return count};
	!fma.demo() && alert("error");
} )();

test( "function_manager", function() {
  ok( 1 == "1", "Passed!" );
  
  fm('test');
  
  equal( typeof fm.test, 'object', "fm.test" );
  equal( typeof fma.test, 'function', "fma.test" );
  
  var count=0;
  fma.test = function(){count++};
  fma.test = function(){return count};
  equal( fma.test(), 1, "setter, getter" );
  
  fm.test.clear();
  fm.test.exec();
  equal( fm.test.exec(), undefined, "clear, exec" );
  
  fm('test');
  
  var count=0;
  fm.test.set( function(){count++} );
  fm.test.set( function(){return count} );
  equal( fm.test.get()(), 1, "set, get" );
  
  var count=0;
  fm.test.pop();
  fm.test.shift();
  fm.test.unshift( function(){count++} );
  fm.test.push( function(){return count} );
  equal( fm.test.get()(), 1, "array prop" );
  
  fm('unique', { unique: true });
  
  fm('connect', { connect: true });
  
  var count=0;
  fma.unique = function(){count++};
  fma.unique = function(){count++};
  fma.unique = function(){return count};
  equal( fma.unique(), 1, "unique" );
  
  var count=0;
  fma.connect = function(){return count};
  fma.connect = function(count){return ++count};
  fma.connect = function(count){return count};
  equal( fma.connect(), 1, "connect" );
  
  equal( fma.demo(), -2, "" );
  
});
</script>
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
</body>
</html>